#TRQMOD
SH A
WT 500
'GET CURRENT CONTROLLER GAINS
KP = _KPA
KD = _KDA
KI = _KIA
TL = _TLA

'SET GAINS TO ZERO FOR TORQUE MODE
KP 0
KD 0
KI 0
TL 3
WT 1000
VEL = 0.0
VELLIMIT = 5000
pos1 = _TPA

OFFSET = 0.0
INCR = 0.001
DONE = 0

#FCTON
OF OFFSET
WT 10
OF -OFFSET
'WT 10

IF (_TVA > VELLIMIT)
OF 0.0
DONE = 1
ENDIF

IF (_TVA < -VELLIMIT)
OF 0.0
DONE = 1
ENDIF

OFFSET = OFFSET + INCR
JP #FCTON, DONE < 1

'RESTORE ORIGINAL VALUES
MO 
KP KP
KD KD
KI KI
TL TL

pos2 = _TPA
delpos = pos2-pos1
EN


